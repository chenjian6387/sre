# 32-期中综合架构验收

如果你看到这里，说明你已经把期中架构的知识点学完了，你已经学会了一半的linux技能了。

剩下的一半学完后，你就可以就业了。

# 1.期中架构图

![image-20220525195926042](http://book.bikongge.com/sre/2024-linux/image-20220525195926042.png)

# 2.必须完成的环节（基础）

```
1. 项目交付PDF + 项目架构图 

2. ansible一键部署整个集群

3. NFS提供静态数据，结合lsyncd做实时数据同步

4. 部署LNMP集群，php、数据库拆开

5. 部署好高可用性负载均衡
```

# 3.加分项（提高）

如下的组件不强制，作为考核加分项；

```
1. 添加https部署，自建即可

2. 部署jumpserver

3. 搭建私有yum仓库

4. 部署ntp服务器
```

# 4.重要声明

```
1. 所有服务器除了lb以外，全部从内网通信；
2. ansible管理机不需要重置，可以提前准备好。其他机器全部重置
3. 必须画图架构图，通信图，以及提供部署项目文档PDF。
4. 基础环境少一项都不及格；
5. 做好每一个机器的备份快照！
```

# 5.期中架构限时

```
1. 给与7天时间完成部署。
2. 基础项完成后，可以挑战提高项；
```

# 6.机器配置建议

```
master-61     3 ~ 4G
lb-5                512m ~ 1G
lb-6                512m ~ 1G
web-7              512m ~ 1G
web-8                512m ~ 1G
web-9                512m ~ 1G
db-51                512m ~ 1G
db-52                512m ~ 1G
nfs-31            512m ~ 1G
backup-41        512m ~ 1G
```

# 7. 架构述职流程如下

```
0. 上台自我介绍，准备好PPT，按照如下流程讲解

1. 先讲解你部署的整体网站架构图

2. 讲解你绘制的网站访问流程图
- 域名解析
- tcp/ip 三次握手
- http请求报文
- http响应报文
- 常见的http状态码
- lb服务器是怎么实现的负载均衡
- web服务器是怎么处理的动静态资源
- 静态资源是怎么挂载的NFS
- NFS数据怎么同步到backup的
- php怎么远程连接到数据库的，需要注意些什么

3.演示环节，查看ansibl部署的效果

3.1 web服务器组
- 访问http://www.yuchaoit.cn 是否重写到https://www.yuchaoit.cn，是否可以正常显示
- 写一篇文章，上传一张图片
- 看看nfs里有图片吗，backup里有图片吗
- 数据库里有文章吗

3.2 lb服务器组
- 演示使用vip访问
- 演示关闭一个lb，VIP漂移吗
- 恢复lb，VIP会恢复吗
- 网站在VIP漂移时，一直都是可以访问的。

3.3 数据库服务器
- db-51 可以正常查看wordpress的数据


# 提高部分
##################################################################
3.4 ntp时间服务器
- ntpdate -u 172.16.1.61

3.5 yum仓库
- 确保客户端都只用了一个repo，是自建的repo。

3.6 堡垒机
- 使用堡垒机连接到内网的服务器（koko）


##################################################################
4. 你学习到了一半了，你的辛酸历程。
- 你自己心态的变化
- 你一天时间的安排
- 遇见过哪些怀疑人生的大坑？
- 印象最深的报错是什么？
- 你对运维的看法
- 想对一年之后的自己说什么

##################################################################
5.感谢环节
- 感谢帮助过你的同学

##################################################################
```