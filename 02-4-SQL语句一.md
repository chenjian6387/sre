# 02-4-SQLè¯­å¥ä¸€

SQLç»ƒä¹ ï¼Œå¯ä»¥å…ˆå¯¼å…¥è¶…å“¥å‡†å¤‡å¥½çš„æ•°æ®åº“æ–‡ä»¶ã€‚

```
https://github.com/datacharmer/test_db   éšæ„å¯¼å…¥ï¼Œç»ƒä¹ SQLç©æ³•


è¿˜æœ‰ä¸ª yuanlai_mysql.sql
```

# 1.MySQlæ ¸å¿ƒSQLè¯­å¥

SQLï¼Œè‹±æ–‡å…¨ç§°ä¸ºStructured Query Languageï¼Œä¸­æ–‡æ„æ€æ˜¯ç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€ï¼Œå®ƒæ˜¯ä¸€ç§å¯¹å…³ç³»å‹æ•°æ®åº“ä¸­çš„æ•°æ®è¿›è¡Œå®šä¹‰å’Œæ“ä½œçš„è¯­è¨€ï¼Œæ˜¯å¤§å¤šæ•°å…³ç³»å‹æ•°æ®åº“ç®¡ç†ç³»ç»Ÿæ‰€æ”¯æŒçš„å·¥ä¸šæ ‡å‡†è¯­è¨€ã€‚

å°±åƒæˆ‘ä»¬å’Œbashæ‰“äº¤é“ï¼Œè¦éµå¾ªbashçš„è¯­æ³•ï¼Œç„¶åå¯ä»¥å¯¹linuxçš„æ•°æ®ï¼Œè¿›è¡Œå¢åˆ æ”¹æŸ¥ã€‚

æˆ‘ä»¬ä½¿ç”¨mysqlè¿™ä¸ªå·¥å…·ï¼Œè¿›è¡Œæ•°æ®ç®¡ç†ï¼Œå°±å¾—éµå¾ªSQLä¸“é—¨çš„è¯­æ³•ï¼Œè¿›è¡Œå­˜å‚¨ã€æŸ¥è¯¢ã€æ›´æ–°ã€ç®¡ç†æ•°æ®åº“å†…å®¹ã€‚

SQLå¸®åŠ©æˆ‘ä»¬ä¸ç”¨å…³æ³¨æ•°æ®åˆ°åº•æ˜¯æ€ä¹ˆåœ¨ç£ç›˜ä¸Šå­˜å‚¨çš„ï¼Œé€šè¿‡é«˜çº§SQLè¯­è¨€ï¼Œèƒ½å¤Ÿéå¸¸ç®€å•çš„å¯¹æ•°æ®ç®¡ç†ï¼Œä»¥åŠå¼ºå¤§çš„çµæ´»æ€§ï¼Œä¸åŒçš„æ•°æ®åº“çš„SQLä¼šæœ‰äº›å·®åˆ«ã€‚

```
ç”¨äºå…³ç³»å‹æ•°æ®åº“ï¼Œmysqlè¿™ä¸ªè½¯ä»¶ä¸­ä¸“æœ‰çš„æŸ¥æ•°æ®çš„è¯­è¨€ï¼Œå«åšç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€ã€‚
```

# 2.æœ‰å…³SQLçš„åˆ†ç±»

![image-20210415221416415](http://book.bikongge.com/sre/2024-linux/image-20210415221416415.png)

```
DDLæ•°æ®å®šä¹‰ï¼Œå…¨ç§°ä¸ºData Definition Language

DQLæ•°æ®æŸ¥è¯¢è¯­è¨€ï¼ŒDQLï¼Œå…¨ç§°ä¸ºData Query Language

DCLæˆæƒæ§åˆ¶,å…¨ç§°ä¸ºData Control Language

DMLæ•°æ®æ“ä½œè¯­è¨€ï¼ŒDMLï¼Œå…¨ç§°ä¸ºData Manipulation Languageï¼Œä¸­æ–‡ä¸ºæ•°æ®æ“ä½œè¯­è¨€
```

## DQLæ•°æ®æŸ¥è¯¢è¯­è¨€

DQLï¼Œå…¨ç§°ä¸ºData Query Languageï¼Œå…¶è¯­å¥ä¹Ÿç§°ä¸ºâ€œæ•°æ®æ£€ç´¢è¯­å¥â€ï¼Œä½œç”¨æ˜¯`ä»è¡¨ä¸­è·å–æ•°æ®ï¼Œç¡®å®šæ•°æ®åº”æ€æ ·åœ¨åº”ç”¨ç¨‹åºä¸­ç»™å‡ºã€‚`

å…³é”®å­—SELECTæ˜¯DQLï¼ˆä¹Ÿæ˜¯æ‰€æœ‰SQLï¼‰ç”¨å¾—æœ€å¤šçš„ï¼Œå…¶ä»–DQLå¸¸ç”¨çš„ä¿ç•™å­—æœ‰WHEREã€ORDER BYã€GROUP BYå’ŒHAVINGã€‚è¿™äº›å•è¯å°±æ˜¯æˆ‘ä»¬è¿™ä¸€èŠ‚è¦å­¦ä¹ çš„SQLè¯­å¥ï¼Œè¿›è¡ŒæŸ¥è¯¢ã€‚

è¿™äº›DQLä¿ç•™å­—å¸¸ä¸å…¶ä»–ç±»å‹çš„SQLè¯­å¥ä¸€èµ·ä½¿ç”¨ã€‚å…·ä½“è¯­å¥ç¤ºä¾‹å¦‚ä¸‹ï¼š

```sql
# ç™»å½•æ•°æ®åº“
[root@mysql-server56 ~]#
[root@mysql-server56 ~]# mysql -S /data/3307/mysql.sock
ERROR 1045 (28000): Access denied for user 'root'@'localhost' (using password: NO)
[root@mysql-server56 ~]# mysql -pyuchao7777 -S /data/3307/mysql.sock
Warning: Using a password on the command line interface can be insecure.
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 4
Server version: 5.6.40-log MySQL Community Server (GPL)

Copyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

# è¿™å¥SQLç¿»è¯‘æ˜¯ä»mysqlåº“ä¸‹çš„userè¡¨ï¼ŒæŸ¥è¯¢userã€hostå­—æ®µçš„æ•°æ®ã€ä¸”å¯¹useræ’åº
# è¿™å°±åƒæˆ‘ä»¬ç”¨excelä¸€æ ·
mysql> select user,host from mysql.user order by user;
+------+----------------+
| user | host           |
+------+----------------+
|      | localhost      |
|      | mysql-server56 |
| root | localhost      |
| root | mysql-server56 |
| root | 127.0.0.1      |
| root | ::1            |
| root | %              |
+------+----------------+
7 rows in set (0.00 sec)
```

## DMLæ•°æ®æ“ä½œè¯­è¨€

DMLï¼Œå…¨ç§°ä¸ºData Manipulation Languageï¼Œä¸­æ–‡ä¸ºæ•°æ®æ“ä½œè¯­è¨€ã€‚

å…¶è¯­å¥çš„å…³é”®å­—ä¸ºINSERTã€UPDATEå’ŒDELETEã€‚å®ƒä»¬åˆ†åˆ«ç”¨äºæ·»åŠ ã€ä¿®æ”¹å’Œåˆ é™¤è¡¨ä¸­çš„è¡Œï¼ˆæ•°æ®ï¼‰ã€‚å…·ä½“è¯­å¥ç¤ºä¾‹å¦‚ä¸‹ï¼š

```sql
# åˆ é™¤è¿™äº›æ— ç”¨çš„ç”¨æˆ·
# å‘ç°åˆ é™¤äº†2ä¸ªç©ºç”¨æˆ·
mysql> delete from mysql.user where user=' ';
Query OK, 2 rows affected (0.00 sec)

mysql> delete from mysql.user where user='root' and host='mysql-server56';
Query OK, 1 row affected (0.00 sec)

mysql> delete from mysql.user where user='root' and host='::1';
Query OK, 1 row affected (0.00 sec)

# å‰©ä¸‹æ¥çš„ç”¨æˆ·
mysql> select user,host from mysql.user order by user;
+------+-----------+
| user | host      |
+------+-----------+
| root | localhost |
| root | 127.0.0.1 |
| root | %         |
+------+-----------+
3 rows in set (0.00 sec)
```

## TPLäº‹åŠ¡

å…¨ç§°ä¸ºTransaction Processing Languageï¼ŒTPLè¯­å¥ç”¨äºç¡®ä¿è¢«DMLè¯­å¥å½±å“çš„è¡¨çš„æ‰€æœ‰è¡Œèƒ½å¤ŸåŠæ—¶å¾—åˆ°æ›´æ–°ã€‚TPLè¯­å¥åŒ…æ‹¬BEGIN TRANSACTIONã€COMMITå’ŒROLLBACKã€‚

## DCLæˆæƒæ§åˆ¶

å…¨ç§°ä¸ºData Control Languageï¼Œè¿™ç±»è¯­å¥é€šè¿‡GRANTæˆ–REVOKEæˆæƒç”¨æˆ·è®¸å¯ï¼Œç¡®å®šå•ä¸ªç”¨æˆ·å’Œç”¨æˆ·ç»„å¯¹æ•°æ®åº“å¯¹è±¡çš„è®¿é—®ã€‚

æŸäº›RDBMSå¯ç”¨GRANTæˆ–REVOKEæ§åˆ¶å¯¹è¡¨ä¸­å•ä¸ªåˆ—çš„è®¿é—®ã€‚

```sql
mysql> create user pyyu@'%' identified by 'pyyu668';
Query OK, 0 rows affected (0.01 sec)

# æ™®é€šç”¨æˆ·è¢«åˆ›å»ºçš„æ—¶å€™ï¼Œé»˜è®¤æœ‰USAGEæƒé™ï¼Œåªèƒ½ç”¨äºç™»å½•æ•°æ®åº“ï¼Œæ— å…¶ä»–æƒé™
mysql> show grants for pyyu@'%';
+-----------------------------------------------------------------------------------------------------+
| Grants for pyyu@%                                                                                   |
+-----------------------------------------------------------------------------------------------------+
| GRANT USAGE ON *.* TO 'pyyu'@'%' IDENTIFIED BY PASSWORD '*4896EFB7643861D41A6BF9CD6FF012B785508323' |
+-----------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

# åªç»™pyyuç”¨æˆ·æŸ¥çœ‹luffyæ•°æ®åº“çš„æŸ¥è¯¢æƒé™
mysql> grant select on luffy.* to 'pyyu'@'%' with grant option;
Query OK, 0 rows affected (0.00 sec)

# æŸ¥è¯¢è¯¥ç”¨æˆ·çš„æƒé™
mysql> show grants for pyyu@'%';
+-----------------------------------------------------------------------------------------------------+
| Grants for pyyu@%                                                                                   |
+-----------------------------------------------------------------------------------------------------+
| GRANT USAGE ON *.* TO 'pyyu'@'%' IDENTIFIED BY PASSWORD '*4896EFB7643861D41A6BF9CD6FF012B785508323' |
| GRANT SELECT ON `luffy`.* TO 'pyyu'@'%' WITH GRANT OPTION                                           |
+-----------------------------------------------------------------------------------------------------+
2 rows in set (0.00 sec)
```

## DDLæ•°æ®å®šä¹‰

å…¨ç§°ä¸ºData Definition Languageï¼Œå…¶è¯­å¥åŒ…æ‹¬åŠ¨è¯CREATEã€DROPå’ŒALTERã€‚å¯ä½¿ç”¨è¯¥è¯­è¨€åœ¨æ•°æ®åº“ä¸­åˆ›å»ºæ–°åº“è¡¨æˆ–åˆ é™¤åº“è¡¨ï¼Œæˆ–è€…ä¸ºè¡¨æ·»åŠ å­—æ®µã€ç´¢å¼•ç­‰ã€‚

```
# è¿™å¥SQLæ„ä¸ºåˆ›å»ºluffyæ•°æ®åº“ï¼Œä¸”è®¾ç½®æ•°æ®åº“ç¼–ç ä¸ºutf8ï¼Œä¸”å¤§å°å†™ä¸æ•æ„Ÿï¼Œaå’ŒAä¸€æ ·å¤„ç†
mysql> create database  if not exists luffy default charset utf8 collate utf8_general_ci;
Query OK, 1 row affected (0.01 sec)

mysql> show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| luffy              |
| mysql              |
| performance_schema |
| test               |
+--------------------+
5 rows in set (0.01 sec)
```

## CCLæŒ‡é’ˆæ§åˆ¶è¯­è¨€

CCLï¼Œå…¨ç§°ä¸ºCURSOR Control Languageï¼Œå®ƒçš„è¯­å¥ï¼ˆåƒDECLARE CURSORã€FETCH INTOå’ŒUPDATE WHERE CURRENTï¼‰ç”¨äºå¯¹ä¸€ä¸ªæˆ–å¤šä¸ªè¡¨çš„å•ç‹¬è¡Œè¿›è¡Œæ“ä½œã€‚

## è¿ç»´å’Œå¼€å‘--SQL

> è¿ç»´ä¸»è¦å…³å¿ƒæ•°æ®åº“çš„æ¶æ„ç»´æŠ¤ã€æ•°æ®å¤‡ä»½ã€åŸºç¡€æ•°æ®çš„ç®¡ç†ã€ä½†æ˜¯ä¸€èˆ¬ä¸ä¼šä¿®æ”¹æ•°æ®è¡¨çš„ç»“æ„

ä¸»è¦ä»¥DDLç±»åˆ«å·¥ä½œä¸ºä¸»ï¼Œä¹Ÿå°±æ˜¯æ•°æ®å®šä¹‰ï¼Œè¿ç»´å’Œå¼€å‘éƒ½å¾—æŒæ¡

- create
- alter
- drop

### æŸ¥çœ‹DDLè¯­å¥å…·ä½“ä¿¡æ¯

```sql
mysql> ? Data Definition
You asked for help about help category: "Data Definition"
For more information, type 'help <item>', where <item> is one of the following
topics:
   ALTER DATABASE
   ALTER EVENT
   ALTER FUNCTION
   ALTER LOGFILE GROUP
   ALTER PROCEDURE
   ALTER SERVER
   ALTER TABLE
   ALTER TABLESPACE
   ALTER VIEW
   CONSTRAINT
   CREATE DATABASE
   CREATE EVENT
   CREATE FUNCTION
   CREATE INDEX
   CREATE LOGFILE GROUP
   CREATE PROCEDURE
   CREATE SERVER
   CREATE TABLE
   CREATE TABLESPACE
   CREATE TRIGGER
   CREATE VIEW
   DROP DATABASE
   DROP EVENT
   DROP FUNCTION
   DROP INDEX
   DROP PROCEDURE
   DROP SERVER
   DROP TABLE
   DROP TABLESPACE
   DROP TRIGGER
   DROP VIEW
   RENAME TABLE
   TRUNCATE TABLE
```

### DCLæ•°æ®æˆæƒæ§åˆ¶

ä¸€èˆ¬æ˜¯è¿ç»´æ“ä½œçš„å¤šäº›

- grant
- revoke
- commit
- Rollback

```sql
mysql> ? Account Management
You asked for help about help category: "Account Management"
For more information, type 'help <item>', where <item> is one of the following
topics:
   ALTER USER
   CREATE USER
   DROP USER
   GRANT
   RENAME USER
   REVOKE
   SET PASSWORD
```

### DMLæ•°æ®æ“ä½œè¯­è¨€

å¼€å‘è¦é‡ç‚¹æŒæ¡çš„SQLï¼Œè¿ç»´ç†Ÿæ‚‰å°±å¥½ï¼Œä¹Ÿå°±æ˜¯DMLæ•°æ®æ“ä½œè¯­è¨€ï¼Œå› ä¸ºç½‘ç«™æœ‰å„å¼å„æ ·çš„æ•°æ®å†™å…¥ã€æ•°æ®è¯»å–æ“ä½œï¼Œè¿™æ˜¯å¼€å‘å¯¹äºè¡¨çš„è®¾è®¡ï¼Œæ˜¯å¼€å‘å¿…é¡»é‡ç‚¹æŒæ¡çš„æŠ€èƒ½ã€‚

è¿ç»´æ— é¡»åƒå¼€å‘ä¸€æ ·ï¼Œäº†è§£å„ç§ä¸šåŠ¡è¡¨çš„ç»“æ„ã€è®¾è®¡ï¼Œåªéœ€è¦ç†Ÿæ‚‰æŸ¥è¯¢æ•°æ®æ“ä½œã€‚

ä¹Ÿå°±æ˜¯DMLè¯­å¥

- select
- insert
- delete
- update

```sql
mysql> ? Data Manipulation
You asked for help about help category: "Data Manipulation"
For more information, type 'help <item>', where <item> is one of the following
topics:
   CALL
   DELETE
   DO
   DUAL
   HANDLER
   INSERT
   INSERT DELAYED
   INSERT SELECT
   JOIN
   LOAD DATA
   LOAD XML
   REPLACE
   SELECT
   UNION
   UPDATE
```

# è¡¥å……ï¼šSQLåº•å±‚è§£æå™¨

ç›®å‰å¤§å®¶éƒ½çŸ¥é“è¾“å…¥ä¸€æ®µæ­£ç¡®çš„SQLè¯­å¥ï¼Œmysqlå°±å¯ä»¥æ‰§è¡Œï¼Œæ‹¿åˆ°ç»“æœï¼Œé‚£ä¹ˆè¿™ä¸ªèƒŒåï¼Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Œå¬è¶…å“¥ç»™å¤§å®¶èŠèŠã€‚

ä¹Ÿå°±æ˜¯ä½ è¾“å…¥mysqlçš„è¿æ¥å‘½ä»¤ï¼Œè¿æ¥æˆåŠŸåï¼Œè¾“å…¥SQLï¼Œè¿™æœŸé—´åº•å±‚å‘ç”Ÿäº†ä»€ä¹ˆã€‚

> å¤§è‡´é¡ºåºæ˜¯
>
> 1.åº”ç”¨ç¨‹åºè¿æ¥mysqlï¼Œå»ºç«‹è¿æ¥
>
> 2.SQLè¿›è¡Œè§£æ
>
> 3.è¿›å…¥å­˜å‚¨å¼•æ“æ‰¾æ•°æ®ï¼Œåœ¨ç£ç›˜ã€å†…å­˜ä¸­è¯»å–æ•°æ®ï¼Œä¾æ¬¡è¿”å›
>
> 4.æ•°æ®è¿”å›ç»™ç”¨æˆ·

![image-20210416111511037](http://book.bikongge.com/sre/2024-linux/image-20210416111511037.png)

## SQLè§£ææµç¨‹

- è¿æ¥å±‚

  - åº”ç”¨ç¨‹åºï¼ˆphpï¼Œpythonï¼Œä»£ç ï¼‰è¿æ¥mysqlæ—¶ï¼Œé¦–å…ˆä¼šè¿›è¿‡è¿æ¥æ± ï¼ˆåˆ›å»ºæ•°æ®åº“è¿æ¥æ˜¯å¾ˆè€—æ—¶ä¸”æ¶ˆè€—èµ„æºçš„ï¼Œæ•°æ®åº“ä¼šæä¾›è¿æ¥æ± ï¼Œä¿æŒè¿æ¥ï¼Œå…è®¸åº”ç”¨ç¨‹åºé‡å¤ä½¿ç”¨ä¸€ä¸ªç°æœ‰çš„è¿æ¥ï¼Œæ— é¡»é‡å¤æ–°å»ºï¼Œçœèµ„æºï¼Œå‡è½»æ•°æ®åº“å‹åŠ›ï¼‰ï¼Œå»ºç«‹è¿æ¥åï¼Œè¿›å…¥SQLè§£æå±‚

- SQLå±‚

  - è¿™ä¸€å±‚æ˜¯è§£æSQLè¯­å¥ï¼Œé¦–å…ˆåˆ¤æ–­SQLæ­£ç¡®æ€§ï¼Œæ˜¯å¦ç¬¦åˆDDLã€DMLã€DCLè¯­å¥è§„åˆ™

  - æ ¹æ®ä¸åŒçš„ç±»å‹ï¼Œå‘½ä»¤åˆ†å‘æ¨¡å—è½¬å‘ç»™å¯¹åº”çš„æ¨¡å—å¤„ç†

    - ä¾‹å¦‚æ¥æ”¶çš„æ˜¯selectè¯­å¥ï¼Œå°±æ˜¯DMLæŸ¥è¯¢ï¼Œæ—¢ç„¶æŸ¥è¯¢ï¼Œå°±ä¼šå»æŸ¥æ‰¾æ˜¯å¦æœ‰ç¼“å­˜

      - æœ‰ç¼“å­˜åˆ™ç›´æ¥è¿”å›ç»™åº”ç”¨ç¨‹åº

      - å¦‚æœæ²¡æœ‰ç¼“å­˜ï¼Œå°±è¿›å…¥äº†SQLçš„è§£ææµç¨‹

        ```
        (Parsing queries)
        ```

        - è§£æè¿™ä»¶äº‹ç”±Parserè§£æå™¨æ¥å¯¹SQLè¿›è¡Œè¯æ³•åˆ†æï¼ˆå› ä¸ºSQLå¯ä»¥æ˜¯ä¸€ä¸ªç»„åˆçš„ï¼Œå¤æ‚ã€è¾ƒé•¿çš„è¯­å¥ï¼‰ï¼Œæœ€ç»ˆåˆ†æå‡ºä¸€ä¸ªæˆ–è€…å¤šä¸ªSQLè¯­å¥çš„æ‰§è¡Œè®¡åˆ’

  - å¾—åˆ°æ‰§è¡Œè®¡åˆ’åï¼Œè¿˜ä¸ä¼šç«‹å³æ‰§è¡Œï¼Œå› ä¸ºè§£æå™¨å¯èƒ½ç»™å‡ºäº†SQLçš„å¤šç§æ‰§è¡Œæ–¹å¼ï¼Œè¿˜è¦å†è¿›ä¸€æ­¥çš„åˆ¤æ–­ï¼Œæ€ä¹ˆæ‰§è¡Œæ‰æ˜¯æœ€é«˜æ•ˆçš„ã€‚

    - mysqlå†…éƒ¨æœ‰ä¸€ä¸ªæŸ¥è¯¢ä¼˜åŒ–å™¨ï¼ˆOptimizerï¼‰æ ¹æ®è‡ªèº«çš„ç®—æ³•ï¼Œæ‰¾åˆ°ä¸€ä¸ªæœ€é«˜æ•ˆçš„æ–¹å¼æ‰§è¡ŒSQLï¼ˆä¾‹å¦‚æœ‰åˆç†ç´¢å¼•çš„é‚£ä¸€æ¡SQLï¼‰

  - å½“ä¼˜åŒ–å™¨ç¡®å®šäº†æ‰§è¡Œè®¡åˆ’ï¼Œæ˜¯ä¸æ˜¯å°±å¯ä»¥ç«‹å³æ‰§è¡Œäº†?ä¸æ˜¯ã€‚ã€‚ï¼ˆå¤§å®¶å¯èƒ½å›éƒé—·äº†ï¼Œè¶…å“¥ä½ è¿™ä¹ˆå¢¨è¿¹å‘¢ï¼Ÿï¼‰å› ä¸ºå³ä½¿ä½ ç¡®å®šäº†SQLå¯ä»¥æ‰§è¡Œäº†ï¼Œä½†æ˜¯ä½ æ˜¯ä¸æ˜¯æœ‰æƒé™æ‰§è¡Œï¼Œå¯¹æŠŠã€‚

  - åœ¨SQLå±‚å†…éƒ¨å¯¹æƒé™ä¹Ÿæ£€æŸ¥åï¼ŒSQLè¯­å¥ç»ˆäºæ‰§è¡Œäº†ï¼Œæœ€åæŠŠæ‰§è¡Œåçš„ç»“æœï¼Œäº¤ç»™æœ€åº•å±‚çš„å­˜å‚¨å¼•æ“æ¥å£ï¼ˆå‘åŠ¨æœºï¼‰ï¼Œå­˜å‚¨å¼•æ“å’Œæ“ä½œç³»ç»Ÿäº¤äº’ï¼Œè¯»å–åˆ°ç£ç›˜ä¸Šçš„æ•°æ®ï¼ˆå‘åŠ¨æœºå–æ²¹å¼€å§‹å¹²æ´»äº†ï¼‰ã€‚

  - æœ€ç»ˆSQLæ‰§è¡Œå®Œæ¯•ï¼Œæœ¬æ¬¡è·å–çš„æ•°æ®ï¼Œå¸¸è§„ä¸‹æ›´æ–°åˆ°ç¼“å­˜ä¸­ï¼Œä¾¿äºä¸‹æ¬¡åŠ é€ŸæŸ¥è¯¢ã€‚

> è¿™ä¸ªæŸ¥è¯¢è¿‡ç¨‹çš„åŸç†ï¼Œæ˜¯å¸Œæœ›å¤§å®¶å¿ƒä¸­æœ‰ä¸ªæ¦‚å¿µï¼ŒæŸ¥è¯¢è¿‡ç¨‹ä¼šå‘ç”Ÿä»€ä¹ˆäº‹ï¼Œå…·ä½“è½åœ°åˆ°æ“ä½œï¼Œmysqlè¿˜æä¾›äº†å¤§é‡çš„SQLè¯­å¥ï¼Œæä¾›æˆ‘ä»¬å¯¹æ•°æ®åº“è¿›è¡Œæ€§èƒ½åˆ†æã€‚åé¢è¶…å“¥ä¼šç»™å¤§å®¶è®²ï¼ï¼

# 3.æ•°æ®åº“å¯¹è±¡

## åº“

```
æ•°æ®åº“å
æ•°æ®åº“å±æ€§ã€å­—ç¬¦é›†ã€æ ¡å¯¹è§„åˆ™ï¼ˆå¤§å°å†™ç­‰ï¼‰
```

ä¾‹å­

```sql
mysql> show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql              |
| performance_schema |
| sys                |
+--------------------+
4 rows in set (0.00 sec)


mysql> show create database mysql;
+----------+------------------------------------------------------------------+
| Database | Create Database                                                  |
+----------+------------------------------------------------------------------+
| mysql    | CREATE DATABASE `mysql` /*!40100 DEFAULT CHARACTER SET latin1 */ |
+----------+------------------------------------------------------------------+
1 row in set (0.00 sec)
```

## è¡¨

```
æ•°æ®åº“.æ•°æ®è¡¨å

åˆ—
    åˆ—å
    åˆ—å±æ€§ï¼šæ•°æ®ç±»å‹ã€çº¦æŸæ¡ä»¶ã€å…¶ä»–å±æ€§


è¡Œ
    å­—æ®µå
    å­—æ®µå±æ€§
```

ä¾‹

```sql
mysql> select Host,User from mysql.user;
+-----------+---------------+
| Host      | User          |
+-----------+---------------+
| 10.0.0.%  | dev01         |
| 10.0.0.%  | yuchao02      |
| 10.0.0.7  | bob01         |
| localhost | chaoge01      |
| localhost | mysql.session |
| localhost | mysql.sys     |
| localhost | root          |
| localhost | yuchao01      |
+-----------+---------------+
8 rows in set (0.00 sec)
```

## å­—ç¬¦é›†

> æˆ‘ä»¬å¦‚æœæƒ³æ­£ç¡®çš„è¯»å†™mysqlçš„ä¸­æ–‡æ•°æ®ï¼Œéœ€è¦ä¿è¯æœåŠ¡ç«¯ã€å®¢æˆ·ç«¯çš„å­—ç¬¦é›†ä¸€è‡´
>
> æœåŠ¡ç«¯æ˜¯æˆ‘ä»¬çš„mysqlï¼Œå®¢æˆ·ç«¯çš„å½¢å¼æœ‰å¾ˆå¤šäº†ï¼Œå¯èƒ½æ˜¯xshellï¼Œnavicatï¼Œç¨‹åºç­‰ç­‰
>
> æœåŠ¡ç«¯mysqlçš„ç¼–ç è®¾ç½®ä¸æŸ¥çœ‹

```perl
# æŸ¥çœ‹mysqlæ”¯æŒå“ªäº›å­—ç¬¦é›†
mysql> show character set;

# æŸ¥çœ‹å½“å‰mysqlæœåŠ¡ç«¯ï¼Œé»˜è®¤æ˜¯ä»€ä¹ˆå­—ç¬¦é›†
# å­—ç¬¦é›†ï¼ˆcharacter setï¼‰ï¼šå®šä¹‰äº†å­—ç¬¦ä»¥åŠå­—ç¬¦çš„ç¼–ç ã€‚

mysql> show variables like '%char%';
+--------------------------+----------------------------------+
| Variable_name            | Value                            |
+--------------------------+----------------------------------+
| character_set_client     | utf8                             |
| character_set_connection | utf8                             |
| character_set_database   | latin1                           |
| character_set_filesystem | binary                           |
| character_set_results    | utf8                             |
| character_set_server     | latin1                           |
| character_set_system     | utf8                             |
| character_sets_dir       | /opt/mysql5.7.28/share/charsets/ |
+--------------------------+----------------------------------+
8 rows in set (0.00 sec)


# æŸ¥çœ‹mysqlé»˜è®¤çš„å­—ç¬¦åº
# å­—ç¬¦åºï¼ˆcollationï¼‰ï¼šå®šä¹‰äº†å­—ç¬¦çš„æ¯”è¾ƒè§„åˆ™ã€‚
mysql> show variables like 'collation%';
+----------------------+-------------------+
| Variable_name        | Value             |
+----------------------+-------------------+
| collation_connection | utf8_general_ci   |
| collation_database   | latin1_swedish_ci |
| collation_server     | latin1_swedish_ci |
+----------------------+-------------------+
3 rows in set (0.00 sec)
```

é˜¿é‡ŒæŠ€æœ¯ä¸“å®¶çš„åšå®¢

https://www.cnblogs.com/chyingp/p/mysql-character-set-collation.html

### å¸¸ç”¨å­—ç¬¦é›†ï¼Œå­—ç¬¦åºç»„åˆ

```
utf-8        æœ€å¤§æ”¯æŒ3å­—èŠ‚çš„å­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯ä¸­æ–‡æ±‰å­—ï¼Œä¸æ”¯æŒemojiç¬¦å·
utf8mb4    æœ€å¤§æ”¯æŒ4å­—èŠ‚çš„å­—ç¬¦ï¼Œæ”¯æŒemojiå­—ç¬¦
mysql8.0ä¹‹å‰ï¼Œé»˜è®¤å­—ç¬¦é›†æ˜¯latin1 
8.0ä¹‹åé»˜è®¤utf8mb4 ï¼Œç›®å‰ä¸»æµç½‘ç«™è‚¯å®šéƒ½æ˜¯æ”¯æŒè¡¨æƒ…ç¬¦å·çš„ï¼Œå¦‚emoji ğŸ˜„è¿™ç±»ã€‚
```

# 4.æ•°æ®è¡¨ï¼ˆæ•°æ®å±æ€§ï¼‰

![image-20220720104405235](http://book.bikongge.com/sre/2024-linux/image-20220720104405235.png)

## æ•°å­—ç±»å‹

MySQL ä¸­å®šä¹‰æ•°æ®å­—æ®µçš„ç±»å‹å¯¹ä½ æ•°æ®åº“çš„ä¼˜åŒ–æ˜¯éå¸¸é‡è¦çš„ã€‚

MySQL æ”¯æŒå¤šç§ç±»å‹ï¼Œå¤§è‡´å¯ä»¥åˆ†ä¸ºä¸‰ç±»ï¼šæ•°å€¼ã€æ—¥æœŸ/æ—¶é—´å’Œå­—ç¬¦ä¸²(å­—ç¬¦)ç±»å‹ã€‚

MySQL æ”¯æŒæ‰€æœ‰æ ‡å‡† SQL æ•°å€¼æ•°æ®ç±»å‹ã€‚

è¿™äº›ç±»å‹åŒ…æ‹¬ä¸¥æ ¼æ•°å€¼æ•°æ®ç±»å‹(INTEGERã€SMALLINTã€DECIMAL å’Œ NUMERIC)ï¼Œä»¥åŠè¿‘ä¼¼æ•°å€¼æ•°æ®ç±»å‹(FLOATã€REAL å’Œ DOUBLE PRECISION)ã€‚

å…³é”®å­—INTæ˜¯INTEGERçš„åŒä¹‰è¯ï¼Œå…³é”®å­—DECæ˜¯DECIMALçš„åŒä¹‰è¯ã€‚

BITæ•°æ®ç±»å‹ä¿å­˜ä½å­—æ®µå€¼ï¼Œå¹¶ä¸”æ”¯æŒ MyISAMã€MEMORYã€InnoDB å’Œ BDBè¡¨ã€‚

ä½œä¸º SQL æ ‡å‡†çš„æ‰©å±•ï¼ŒMySQL ä¹Ÿæ”¯æŒæ•´æ•°ç±»å‹ TINYINTã€MEDIUMINT å’Œ BIGINTã€‚ä¸‹é¢çš„è¡¨æ˜¾ç¤ºäº†éœ€è¦çš„æ¯ä¸ªæ•´æ•°ç±»å‹çš„å­˜å‚¨å’ŒèŒƒå›´ã€‚

| ç±»å‹         | å¤§å°                                     | èŒƒå›´ï¼ˆæœ‰ç¬¦å·ï¼‰                                               | èŒƒå›´ï¼ˆæ— ç¬¦å·ï¼‰                                               | ç”¨é€”            |
| :----------- | :--------------------------------------- | :----------------------------------------------------------- | :----------------------------------------------------------- | :-------------- |
| TINYINT      | 1 Bytes                                  | (-128ï¼Œ127)                                                  | (0ï¼Œ255)                                                     | å°æ•´æ•°å€¼        |
| SMALLINT     | 2 Bytes                                  | (-32 768ï¼Œ32 767)                                            | (0ï¼Œ65 535)                                                  | å¤§æ•´æ•°å€¼        |
| MEDIUMINT    | 3 Bytes                                  | (-8 388 608ï¼Œ8 388 607)                                      | (0ï¼Œ16 777 215)                                              | å¤§æ•´æ•°å€¼        |
| INTæˆ–INTEGER | 4 Bytes                                  | (-2 147 483 648ï¼Œ2 147 483 647)                              | (0ï¼Œ4 294 967 295)                                           | å¤§æ•´æ•°å€¼        |
| BIGINT       | 8 Bytes                                  | (-9,223,372,036,854,775,808ï¼Œ9 223 372 036 854 775 807)      | (0ï¼Œ18 446 744 073 709 551 615)                              | æå¤§æ•´æ•°å€¼      |
| FLOAT        | 4 Bytes                                  | (-3.402 823 466 E+38ï¼Œ-1.175 494 351 E-38)ï¼Œ0ï¼Œ(1.175 494 351 E-38ï¼Œ3.402 823 466 351 E+38) | 0ï¼Œ(1.175 494 351 E-38ï¼Œ3.402 823 466 E+38)                  | å•ç²¾åº¦ æµ®ç‚¹æ•°å€¼ |
| DOUBLE       | 8 Bytes                                  | (-1.797 693 134 862 315 7 E+308ï¼Œ-2.225 073 858 507 201 4 E-308)ï¼Œ0ï¼Œ(2.225 073 858 507 201 4 E-308ï¼Œ1.797 693 134 862 315 7 E+308) | 0ï¼Œ(2.225 073 858 507 201 4 E-308ï¼Œ1.797 693 134 862 315 7 E+308) | åŒç²¾åº¦ æµ®ç‚¹æ•°å€¼ |
| DECIMAL      | å¯¹DECIMAL(M,D) ï¼Œå¦‚æœM>Dï¼Œä¸ºM+2å¦åˆ™ä¸ºD+2 | ä¾èµ–äºMå’ŒDçš„å€¼                                               | ä¾èµ–äºMå’ŒDçš„å€¼                                               | å°æ•°å€¼          |

## å­—ç¬¦ä¸²ç±»å‹

å­—ç¬¦ä¸²ç±»å‹æŒ‡CHARã€VARCHARã€BINARYã€VARBINARYã€BLOBã€TEXTã€ENUMå’ŒSETã€‚è¯¥èŠ‚æè¿°äº†è¿™äº›ç±»å‹å¦‚ä½•å·¥ä½œä»¥åŠå¦‚ä½•åœ¨æŸ¥è¯¢ä¸­ä½¿ç”¨è¿™äº›ç±»å‹ã€‚

| ç±»å‹       | å¤§å°                  | ç”¨é€”                            |
| :--------- | :-------------------- | :------------------------------ |
| CHAR       | 0-255 bytes           | å®šé•¿å­—ç¬¦ä¸²                      |
| VARCHAR    | 0-65535 bytes         | å˜é•¿å­—ç¬¦ä¸²                      |
| TINYBLOB   | 0-255 bytes           | ä¸è¶…è¿‡ 255 ä¸ªå­—ç¬¦çš„äºŒè¿›åˆ¶å­—ç¬¦ä¸² |
| TINYTEXT   | 0-255 bytes           | çŸ­æ–‡æœ¬å­—ç¬¦ä¸²                    |
| BLOB       | 0-65 535 bytes        | äºŒè¿›åˆ¶å½¢å¼çš„é•¿æ–‡æœ¬æ•°æ®          |
| TEXT       | 0-65 535 bytes        | é•¿æ–‡æœ¬æ•°æ®                      |
| MEDIUMBLOB | 0-16 777 215 bytes    | äºŒè¿›åˆ¶å½¢å¼çš„ä¸­ç­‰é•¿åº¦æ–‡æœ¬æ•°æ®    |
| MEDIUMTEXT | 0-16 777 215 bytes    | ä¸­ç­‰é•¿åº¦æ–‡æœ¬æ•°æ®                |
| LONGBLOB   | 0-4 294 967 295 bytes | äºŒè¿›åˆ¶å½¢å¼çš„æå¤§æ–‡æœ¬æ•°æ®        |
| LONGTEXT   | 0-4 294 967 295 bytes | æå¤§æ–‡æœ¬æ•°æ®                    |

**æ³¨æ„**ï¼šchar(n) å’Œ varchar(n) ä¸­æ‹¬å·ä¸­ n ä»£è¡¨å­—ç¬¦çš„ä¸ªæ•°ï¼Œå¹¶ä¸ä»£è¡¨å­—èŠ‚ä¸ªæ•°ï¼Œæ¯”å¦‚ CHAR(30) å°±å¯ä»¥å­˜å‚¨ 30 ä¸ªå­—ç¬¦ã€‚

CHAR å’Œ VARCHAR ç±»å‹ç±»ä¼¼ï¼Œä½†å®ƒä»¬ä¿å­˜å’Œæ£€ç´¢çš„æ–¹å¼ä¸åŒã€‚å®ƒä»¬çš„æœ€å¤§é•¿åº¦å’Œæ˜¯å¦å°¾éƒ¨ç©ºæ ¼è¢«ä¿ç•™ç­‰æ–¹é¢ä¹Ÿä¸åŒã€‚åœ¨å­˜å‚¨æˆ–æ£€ç´¢è¿‡ç¨‹ä¸­ä¸è¿›è¡Œå¤§å°å†™è½¬æ¢ã€‚

BINARY å’Œ VARBINARY ç±»ä¼¼äº CHAR å’Œ VARCHARï¼Œä¸åŒçš„æ˜¯å®ƒä»¬åŒ…å«äºŒè¿›åˆ¶å­—ç¬¦ä¸²è€Œä¸è¦éäºŒè¿›åˆ¶å­—ç¬¦ä¸²ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä»¬åŒ…å«å­—èŠ‚å­—ç¬¦ä¸²è€Œä¸æ˜¯å­—ç¬¦å­—ç¬¦ä¸²ã€‚è¿™è¯´æ˜å®ƒä»¬æ²¡æœ‰å­—ç¬¦é›†ï¼Œå¹¶ä¸”æ’åºå’Œæ¯”è¾ƒåŸºäºåˆ—å€¼å­—èŠ‚çš„æ•°å€¼å€¼ã€‚

BLOB æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶å¤§å¯¹è±¡ï¼Œå¯ä»¥å®¹çº³å¯å˜æ•°é‡çš„æ•°æ®ã€‚æœ‰ 4 ç§ BLOB ç±»å‹ï¼šTINYBLOBã€BLOBã€MEDIUMBLOB å’Œ LONGBLOBã€‚å®ƒä»¬åŒºåˆ«åœ¨äºå¯å®¹çº³å­˜å‚¨èŒƒå›´ä¸åŒã€‚

æœ‰ 4 ç§ TEXT ç±»å‹ï¼šTINYTEXTã€TEXTã€MEDIUMTEXT å’Œ LONGTEXTã€‚å¯¹åº”çš„è¿™ 4 ç§ BLOB ç±»å‹ï¼Œå¯å­˜å‚¨çš„æœ€å¤§é•¿åº¦ä¸åŒï¼Œå¯æ ¹æ®å®é™…æƒ…å†µé€‰æ‹©ã€‚

## æ—¥æœŸå’Œæ—¶é—´ç±»å‹

è¡¨ç¤ºæ—¶é—´å€¼çš„æ—¥æœŸå’Œæ—¶é—´ç±»å‹ä¸ºDATETIMEã€DATEã€TIMESTAMPã€TIMEå’ŒYEARã€‚

æ¯ä¸ªæ—¶é—´ç±»å‹æœ‰ä¸€ä¸ªæœ‰æ•ˆå€¼èŒƒå›´å’Œä¸€ä¸ª"é›¶"å€¼ï¼Œå½“æŒ‡å®šä¸åˆæ³•çš„MySQLä¸èƒ½è¡¨ç¤ºçš„å€¼æ—¶ä½¿ç”¨"é›¶"å€¼ã€‚

TIMESTAMPç±»å‹æœ‰ä¸“æœ‰çš„è‡ªåŠ¨æ›´æ–°ç‰¹æ€§ï¼Œå°†åœ¨åé¢æè¿°ã€‚

| ç±»å‹      | å¤§å° ( bytes) | èŒƒå›´                                                         | æ ¼å¼                | ç”¨é€”                     |
| :-------- | :------------ | :----------------------------------------------------------- | :------------------ | :----------------------- |
| DATE      | 3             | 1000-01-01/9999-12-31                                        | YYYY-MM-DD          | æ—¥æœŸå€¼                   |
| TIME      | 3             | '-838:59:59'/'838:59:59'                                     | HH:MM:SS            | æ—¶é—´å€¼æˆ–æŒç»­æ—¶é—´         |
| YEAR      | 1             | 1901/2155                                                    | YYYY                | å¹´ä»½å€¼                   |
| DATETIME  | 8             | 1000-01-01 00:00:00/9999-12-31 23:59:59                      | YYYY-MM-DD HH:MM:SS | æ··åˆæ—¥æœŸå’Œæ—¶é—´å€¼         |
| TIMESTAMP | 4             | 1970-01-01 00:00:00/2038ç»“æŸæ—¶é—´æ˜¯ç¬¬ **2147483647** ç§’ï¼ŒåŒ—äº¬æ—¶é—´ **2038-1-19 11:14:07**ï¼Œæ ¼æ—å°¼æ²»æ—¶é—´ 2038å¹´1æœˆ19æ—¥ å‡Œæ™¨ 03:14:07 | YYYYMMDD HHMMSS     | æ··åˆæ—¥æœŸå’Œæ—¶é—´å€¼ï¼Œæ—¶é—´æˆ³ |

# 5.æ•°æ®è¡¨ï¼ˆåˆ—çº¦æŸï¼‰

![image-20220720104211870](http://book.bikongge.com/sre/2024-linux/image-20220720104211870.png)

## ä¸»é”® primary key ç®€ç§°pk

```
ç‰¹ç‚¹
1. ä¸€å¼ è¡¨ï¼Œåªèƒ½æœ‰ä¸€ä¸ªpkï¼Œå¯ä»¥ç”±å¤šä¸ªåˆ—æ„æˆ
2. ç­‰äº å”¯ä¸€çº¦æŸï¼ˆUnique Keyï¼‰å’Œéç©ºçº¦æŸï¼ˆNOT NULLï¼‰ çš„ç»„åˆ
3. å»ºè®®æ¯å¼ è¡¨éƒ½è¦è®¾ç½®ä¸»é”®ï¼Œä¾¿äºç´¢å¼•çš„åº”ç”¨ï¼Œä¸€èˆ¬éƒ½ä»¥idåˆ—ä¸ºä¸»é”®ï¼Œæ˜¯é»˜è®¤è‡ªå¢çš„æ•°å­—åˆ—ã€‚
```

## éç©º not null

```
è¯¥å­—æ®µå¿…é¡»å†™å…¥æ•°æ®
å»ºè®®æ¯ä¸€åˆ—éƒ½è®¾ç½®ï¼Œä¾¿äºç´¢å¼•åº”ç”¨
```

## å”¯ä¸€æ€§ unique key

```
è¯¥åˆ—çš„å€¼ä¸å¾—é‡å¤ï¼Œä½ æ¯”å¦‚å­˜å‚¨èº«ä»½è¯å·çš„åˆ—ï¼Œæ¯ä¸€ä¸ªäººçš„å·ç éƒ½æ˜¯å”¯ä¸€ï¼Œä¸å¾—é‡å¤ï¼Œå¾—å¿…é¡»æœ‰æ•°æ®çš„
```

## æ— ç¬¦å· unsingned

```
é’ˆå¯¹æ•°å­—æ•°æ®ç±»å‹è€Œè¨€ï¼Œæ˜¯å¦æœ‰ç¬¦å·ï¼Œå¦‚è´Ÿæ•°
```

## å…¶ä»–å±æ€§

```
1.è¡¨å±æ€§
engineï¼Œå­˜å‚¨å¼•æ“ç±»å‹ï¼Œé»˜è®¤æ˜¯innodb
charsetï¼Œå­—ç¬¦é›†ï¼Œutf8mb4
commentï¼Œæ³¨é‡Š


åˆ—å±æ€§
default ï¼Œä¹Ÿå°±æ˜¯å­—æ®µçš„é»˜è®¤å€¼ï¼Œä¸€èˆ¬å’Œnot nullä¸ä¸ºç©ºç»“åˆç”¨ï¼Œè®¾ç½®ä¸ªé»˜è®¤å€¼ï¼Œå¦‚æ€§åˆ«ä¸é€‰ï¼Œé»˜è®¤æ˜¯ç”·

auto_incrementï¼Œæ•°å­—å­—æ®µï¼Œè‡ªå¢é•¿ï¼Œä¸€èˆ¬é…åˆä¸»é”®ä½¿ç”¨ï¼Œå¦‚ç”¨æˆ·ä¿¡æ¯è¡¨ï¼Œidä¾æ¬¡çš„+1

commentï¼Œåˆ—çš„æ³¨é‡Š
```

# 1.DDLæ•°æ®åº“å®šä¹‰è¯­è¨€

DDLçš„ç‰¹ç‚¹æ˜¯å¯¹æ•°æ®åº“å†…éƒ¨çš„å¯¹è±¡è¿›è¡Œåˆ›å»ºã€ä¿®æ”¹ã€åˆ é™¤ç­‰æ“ä½œï¼Œä¸æ¶‰åŠå¯¹è¡¨ä¸­å†…å®¹çš„æ“ä½œå’Œæ›´æ”¹ã€‚

è¿™éƒ¨åˆ†æ˜¯è¿ç»´äººå‘˜æˆ–DBAéœ€è¦ç†Ÿç»ƒæŒæ¡çš„å†…å®¹ï¼Œå¼€å‘äººå‘˜äº†è§£å³å¯ã€‚

å…¨ç§°ä¸ºData Definition Languageï¼Œå…¶è¯­å¥åŒ…æ‹¬åŠ¨è¯CREATEã€DROPå’ŒALTERã€‚å¯ä½¿ç”¨è¯¥è¯­è¨€åœ¨æ•°æ®åº“ä¸­åˆ›å»ºæ–°åº“è¡¨æˆ–åˆ é™¤åº“è¡¨ï¼Œæˆ–è€…ä¸ºè¡¨æ·»åŠ å­—æ®µã€ç´¢å¼•ç­‰ã€‚

> åˆ›å»ºæ•°æ®åº“

ä¸å¾—å·²æ•°å­—å¼€å¤´ï¼Œå¤§å°å†™ä¸æ•æ„Ÿ

## 1.1 æ•°æ®åº“éƒ¨åˆ†

```
1. åº“åä¸å¾—ä»¥æ•°å­—å¼€å¤´
2. åº“åå’Œä¸šåŠ¡æœ‰å…³ï¼Œè§åçŸ¥æ„
3. åº“åä¸å¾—æœ‰å¤§å†™å­—æ¯

éƒ½æ˜¯ä¸ºäº†å¤šç³»ç»Ÿå¹³å°çš„å…¼å®¹æ€§

4.åˆ›å»ºæ•°æ®åº“éœ€è¦æœ‰æŒ‡å®šçš„å­—ç¬¦é›†ï¼Œå»ºè®®è®¾å®šé»˜è®¤è§„åˆ™å°±æ˜¯utf8mb4

5.ç”Ÿäº§ç¯å¢ƒä¸‹ï¼Œç¦ç”¨æ™®é€šç”¨æˆ·çš„drop databaseæƒé™
```

## 1.2 åˆ›å»ºæ•°æ®åº“

```
å®Œæ•´å†™æ³•ï¼ˆå¯ä»¥è§£å†³æ•°æ®åº“å·²å­˜åœ¨çš„å†²çªï¼‰
create database  if not exists kings default charset utf8mb4 ;

åŸºæœ¬å†™æ³•
create database yuchao_linux charset utf8;
create database yuchao_linux charset utf8mb4;
```

## 1.3 æŸ¥çœ‹æ•°æ®åº“

```
mysql> show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |    # ç³»ç»Ÿè‡ªå¸¦åº“ï¼Œå­˜å‚¨æ•°æ®åº“å†…ç½®ä¿¡æ¯
| kings                |
| luffy              |
| mysql              |    # è‡ªå¸¦åº“ï¼Œå­˜å‚¨ç”¨æˆ·ä¿¡æ¯ï¼Œæˆæƒç­‰
| performance_schema |    # å­˜å‚¨å’Œæ€§èƒ½ç›¸å…³çš„æ•°æ®
| test               | 
+--------------------+

# æŸ¥çœ‹show createå¸®åŠ©ä¿¡æ¯
help show create database



å…·ä½“ç”¨æ³•ï¼ŒæŸ¥çœ‹å»ºåº“çš„è¯­å¥ï¼Œå¯ä»¥å¤ç”¨

show create database yuchao_linux;
show create database kings;
```

### 1.3.1 å­—ç¬¦é›†å’Œæ ¡éªŒè§„åˆ™

```
# åˆ›å»ºæ•°æ®åº“ä»¥åŠæŒ‡å®šå­—ç¬¦é›†ï¼Œæ ¡éªŒè§„åˆ™

1. å­—ç¬¦é›†ï¼Œcharacter setï¼Œå°±æ˜¯ä¸€å¥—è¡¨ç¤ºå­—ç¬¦çš„ç¬¦å·å’Œè¿™äº›çš„ç¬¦å·çš„åº•å±‚ç¼–ç ï¼›
2. æ ¡éªŒè§„åˆ™ï¼Œåˆ™æ˜¯åœ¨å­—ç¬¦é›†å†…ç”¨äºæ¯”è¾ƒå­—ç¬¦çš„ä¸€å¥—è§„åˆ™ã€‚


# æŸ¥çœ‹å½“å‰æ•°æ®åº“æ”¯æŒçš„å­—ç¬¦é›†
# maxlenè¡¨ç¤ºè¦ç”¨æœ€å¤§å¤šå°‘ä¸ªå­—èŠ‚æ¥å­˜å‚¨å­—ç¬¦é›†çš„å•ä¸ªè¯ï¼Œdefault collationè¡¨ç¤ºè¯¥å­—ç¬¦é›†çš„é»˜è®¤æ ¡éªŒè§„åˆ™ã€‚

show character set;


# æŸ¥è¯¢mysqlæ•°æ®åº“æ‰€æ”¯æŒå­—ç¬¦é›†çš„æ ¡éªŒè§„åˆ™
show collation;

# å…ˆç®€å•äº†è§£å³å¯ï¼Œåœ¨é‡è§ä¸åŒè¯­è¨€ï¼Œä¸­è‹±æ–‡ï¼Œä»¥åŠåŒ…å«ç‰¹æ®Šç¬¦å·çš„ç¯å¢ƒä¸‹ï¼Œå°±éœ€è¦æŸ¥é˜…ï¼Œè°ƒæ•´æ•°æ®åº“ç¼–ç äº†

ä¸»æµç”¨æ³•ç»„åˆ
utf8mb4 å­—ç¬¦é›†   
utf8mb4_general_ciæ’åºè§„åˆ™
```

## 1.4 ä¿®æ”¹æ•°æ®åº“å­—ç¬¦é›†

```
mysql> show create database yuchao_linux;
+--------------+-----------------------------------------------------------------------+
| Database     | Create Database                                                       |
+--------------+-----------------------------------------------------------------------+
| yuchao_linux | CREATE DATABASE `yuchao_linux` /*!40100 DEFAULT CHARACTER SET utf8 */ |
+--------------+-----------------------------------------------------------------------+
1 row in set (0.00 sec)

# ä¿®æ”¹æ•°æ®åº“ç¼–ç 
mysql> alter database yuchao_linux charset utf8mb4;
Query OK, 1 row affected (0.00 sec)


mysql> show create database yuchao_linux;
+--------------+--------------------------------------------------------------------------+
| Database     | Create Database                                                          |
+--------------+--------------------------------------------------------------------------+
| yuchao_linux | CREATE DATABASE `yuchao_linux` /*!40100 DEFAULT CHARACTER SET utf8mb4 */ |
+--------------+--------------------------------------------------------------------------+
1 row in set (0.00 sec)
```

## 1.5 è®¾ç½®mysqldé»˜è®¤å­—ç¬¦é›†

è¯¥é…ç½®æ–‡ä»¶

```
[root@db-51 ~]#cat /etc/my.cnf 
[mysqld]
character_set_server=utf8mb4
port=3306
user=mysql
basedir=/opt/mysql
datadir=/www.yuchaoit.cn/mysql_3306
socket=/tmp/mysql.sock

[mysql]
socket=/tmp/mysql.sock


é‡å¯
[root@db-51 ~]#systemctl restart mysql
```

å†æ¬¡åˆ›å»ºæ•°æ®åº“è¯•è¯•

```
mysql> create database kings_linux;
Query OK, 1 row affected (0.00 sec)

mysql> show create database kings_linux;
+-------------+-------------------------------------------------------------------------+
| Database    | Create Database                                                         |
+-------------+-------------------------------------------------------------------------+
| kings_linux | CREATE DATABASE `kings_linux` /*!40100 DEFAULT CHARACTER SET utf8mb4 */ |
+-------------+-------------------------------------------------------------------------+
1 row in set (0.00 sec)
```

## 1.6 æ•°æ®è¡¨éƒ¨åˆ†

### è¡¨å®šä¹‰è§„èŒƒ

### åˆ›å»ºè¡¨

```
1.åˆ›å»ºè¡¨
    a.è¡¨åçš„è§„èŒƒ
        ä¸å¾—æ•°å­—å¼€å¤´
        è§åçŸ¥æ„ï¼Œè¡¨å’Œä¸šåŠ¡æœ‰å…³ï¼Œå‚è€ƒwordpressç­‰æ•°æ®åº“å‘½åè§„èŒƒï¼Œå¦‚yuchaoit_post
        ä¸å¾—å¤§å†™å­—æ¯
        åˆ«è¶…è¿‡18ä¸ªå­—ç¬¦
        åˆ«æ˜¯mysqlé»˜è®¤å…³é”®å­—
    b. é»˜è®¤å­˜å‚¨å¼•æ“æ˜¯innodb
    c. 5.7ä¹‹åï¼Œæ•°æ®è¡¨å­—ç¬¦é›†ï¼Œé»˜è®¤utf8mb4
    d. æ•°æ®è¡¨çš„å­—æ®µï¼ˆåˆ—ï¼‰ä¹Ÿå’Œä¸šåŠ¡æœ‰å…³ï¼Œå­—ç¬¦åˆ«è¶…è¿‡18ä¸ª
    e. æ•°æ®è¡¨çš„å­—æ®µï¼ˆåˆ—ï¼‰è¦é€‰æ‹©åˆé€‚çš„ã€è¶³å¤Ÿå®¹é‡ã€çœç£ç›˜ç©ºé—´çš„æ•°æ®ç±»å‹
    f. æ•°æ®è¡¨çš„å­—æ®µï¼ˆåˆ—ï¼‰å»ºè®®éƒ½not null
    g. æ•°æ®è¡¨çš„å­—æ®µï¼ˆåˆ—ï¼‰å»ºè®®éƒ½è¦æœ‰æ³¨é‡Š
    h. æ•°æ®è¡¨çš„å­—æ®µï¼ˆåˆ—ï¼‰ æ¯å¼ æ•°æ®è¡¨éƒ½å»ºè®®åŠ ä¸»é”®
    i. é’ˆå¯¹not nullçš„åˆ—ï¼Œä¸€èˆ¬ç»™ä¸é»˜è®¤å€¼
    j. ç»™æ¯å¼ è¡¨æ·»åŠ æ³¨é‡Š
```

### ä¿®æ”¹è¡¨

```
1. æ·»åŠ æ•°æ®è¡¨çš„å­—æ®µï¼ˆåˆ—ï¼‰ï¼Œå»ºè®®ç”¨è¿½åŠ æ–¹å¼
2. ä¿®æ”¹åˆ—çš„å±æ€§ï¼Œå»ºè®®ç”¨modifyè¯­å¥
3. ä¿®æ”¹è¡¨çš„å±æ€§ï¼Œå»ºè®®åœ¨ä¸šåŠ¡ä¸ç¹å¿™çš„æ—¶å€™ä¿®æ”¹
```

## 1.7 ç”Ÿäº§çº§SQLå®¡æ ¸å·¥å…·

dbaä¸“ç”¨

https://yearning.io/

https://hanchuanchuan.github.io/goInception/

## 1.8 å›¾å½¢åŒ–å·¥å…·navicatå®æˆ˜

### åˆ›å»ºåº“

![image-20220720141903735](http://book.bikongge.com/sre/2024-linux/image-20220720141903735.png)

```
mysql> create database d1;
Query OK, 1 row affected (0.00 sec)

mysql> show create database d1;
+----------+---------------------------------------------------------------+
| Database | Create Database                                               |
+----------+---------------------------------------------------------------+
| d1       | CREATE DATABASE `d1` /*!40100 DEFAULT CHARACTER SET latin1 */ |
+----------+---------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> 


# è¯¥ç‰¹æ®Šç¬¦å· /*!40100 æ˜¯mysqlä¸ºäº†å…¼å®¹ä¸åŒç‰ˆæœ¬çš„å­—ç¬¦é›†ï¼Œè‡ªåŠ¨ç”Ÿæˆçš„ä¸€ä¸ªæ³¨é‡Šä¿¡æ¯ï¼Œå¿½ç•¥å³å¯ï¼Œä¸éœ€è¦ä½ å»å†™
```

### åˆ›å»ºè¡¨

![image-20220720144031607](http://book.bikongge.com/sre/2024-linux/image-20220720144031607.png)

> å¼ºçƒˆå»ºè®®å¤§å®¶çš„ç©æ³•ï¼Œå…ˆç”¨SQLï¼Œå†å»ç”¨å›¾å½¢åŒ–åˆ›å»ºã€‚
>
> ä»¥åç†Ÿç»ƒSQLäº†ï¼Œå¯ä»¥ç›´æ¥å›¾å½¢åŒ–åˆ›å»ºï¼Œç„¶åè½¬ä¸ºSQLï¼Œä¾¿äºå‘½ä»¤è¡Œç”¨ã€‚

#### å¦‚ä½•åˆ›å»ºè¡¨çš„è¯­æ³•

```
help create table;
CREATE TABLE `students` (
  `id` int(11) NOT NULL AUTO_INCREMENT COMMENT 'å­¦å·',
  `name` varchar(64) NOT NULL COMMENT 'å­¦ç”Ÿå§“å',
  `age` tinyint(3) NOT NULL DEFAULT '0' COMMENT 'å­¦ç”Ÿå¹´é¾„',
  `gender` enum('ç”·','å¥³') NOT NULL COMMENT 'å­¦ç”Ÿæ€§åˆ«',
  `address` enum('åŒ—äº¬','æ·±åœ³','äº‘å—','æ±Ÿè‹') NOT NULL COMMENT 'çœä»½',
  `intime` datetime NOT NULL COMMENT 'å…¥å­¦æ—¶é—´',
  `phone` char(11) NOT NULL COMMENT 'æ‰‹æœºå·',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

![image-20220720144109883](http://book.bikongge.com/sre/2024-linux/image-20220720144109883.png)

#### è¡¨å­—æ®µï¼Œæ•°æ®ç±»å‹

```
int                æ•´æ•°ï¼Œæœ‰ç¬¦å· -2^31 åˆ° 2^31-1  ï¼ˆ-2147483648  ~  2147483647 ï¼‰
tinyint          æœ€å°æ•´æ•°ï¼Œ-128 åˆ° 127ï¼Œå¦‚å¹´é¾„
varchar         å­—ç¬¦ç±»å‹ï¼Œå˜åŒ–é•¿åº¦ï¼Œå¦‚èº«ä»½è¯
char            å­—ç¬¦ç±»å‹ï¼Œå›ºå®šé•¿åº¦
enum            æšä¸¾ç±»å‹ï¼Œå¦‚æ€§åˆ«äºŒé€‰ä¸€ï¼Œä¸‰é€‰ä¸€è¡Œä¸è¡Œï¼Ÿ
datetime         æ—¶é—´ç±»å‹ï¼Œå¦‚ä¸‹å•æ—¶é—´ï¼Œå‘è¡¨æ–‡ç« æ—¶é—´ï¼Œæ³¨å†Œæ—¶é—´ç­‰


# ç®€å•ç©ä¸€ç©æ•°æ®ç±»å‹
# ç©ç©intèŒƒå›´
mysql> create table t1(id int);
Query OK, 0 rows affected (0.01 sec)


mysql> insert into t1 values(2147483647);
Query OK, 1 row affected (0.01 sec)

mysql> insert into t1 values(2147483648);
ERROR 1264 (22003): Out of range value for column 'id' at row 1

mysql> insert into t1 values(-2147483648);
Query OK, 1 row affected (0.00 sec)

mysql> insert into t1 values(-2147483649);
ERROR 1264 (22003): Out of range value for column 'id' at row 1


# ç©ç©tinyint
create table t2(age tinyint);

insert into t2 values(128);
insert into t2 values(127);

# ç©ç©charå›ºå®šé•¿åº¦
create table t3(name char(4)) charset utf8;
insert into t3 values('jntmm');
insert into t3 values('jntmm');

# ç©ç©æšä¸¾ç±»å‹
create table t4(gender enum('male','female','unknown'));
insert into t4 values('cxk');
insert into t4 values('male');
insert into t4 values('female');
insert into t4 values('unknown');

# ç©ç©æ—¥æœŸç±»å‹datetime
create table t5(in_school_time  datetime );

æŸ¥çœ‹æ’å…¥æ•°æ®çš„è¯­æ³• 
 ? datetime


insert into t5 values("1993-1-25");
insert into t5 values("1993/1/25");
insert into t5 values("199333/1/25 ");
insert into t5 values("1993/133/25");
insert into t5 values("1993133/25");
insert into t5 values("14-3-1933");
insert into t5 values("3-2-2 3:22:11");
```

### å‘½ä»¤è¡Œå·¥å…·

![image-20220720144133439](http://book.bikongge.com/sre/2024-linux/image-20220720144133439.png)

```sql
# æŸ¥çœ‹å½“å‰å®¢æˆ·ç«¯
mysql> select user();
+-------------------+
| user()            |
+-------------------+
| yuchao02@10.0.0.1 |
+-------------------+
1 row in set (0.01 sec)

# æŸ¥çœ‹æ‰€æœ‰åº“
mysql> show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| kings              |
| kings_linux        |
| mysql              |
| performance_schema |
| sys                |
| yuchao_linux       |
| yuchaoit_mysql     |
+--------------------+
8 rows in set (0.02 sec)



# æŸ¥çœ‹å»ºåº“è¯­å¥SQL
mysql> show create database yuchaoit_mysql;
+----------------+----------------------------------------------------------------------------+
| Database       | Create Database                                                            |
+----------------+----------------------------------------------------------------------------+
| yuchaoit_mysql | CREATE DATABASE `yuchaoit_mysql` /*!40100 DEFAULT CHARACTER SET utf8mb4 */ |
+----------------+----------------------------------------------------------------------------+
1 row in set (0.02 sec)



mysql> 


# æŸ¥çœ‹å»ºè¡¨è¯­å¥SQL
mysql> show create table students;
+----------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Table    | Create Table                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
+----------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| students | CREATE TABLE `students` (
  `id` int(11) NOT NULL AUTO_INCREMENT COMMENT 'å­¦å·',
  `name` varchar(64) NOT NULL COMMENT 'å­¦ç”Ÿå§“å',
  `age` tinyint(3) NOT NULL DEFAULT '0' COMMENT 'å­¦ç”Ÿå¹´é¾„',
  `gender` enum('ç”·','å¥³') NOT NULL COMMENT 'å­¦ç”Ÿæ€§åˆ«',
  `address` enum('åŒ—äº¬','æ·±åœ³','äº‘å—','æ±Ÿè‹') NOT NULL COMMENT 'çœä»½',
  `intime` datetime NOT NULL COMMENT 'å…¥å­¦æ—¶é—´',
  `phone` char(11) NOT NULL COMMENT 'æ‰‹æœºå·',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 |
+----------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.04 sec)


# æŸ¥çœ‹å½“å‰åœ¨é‚£ä¸ªåº“
mysql> select database();
+--------------+
| database()   |
+--------------+
| yuchao_linux |
+--------------+
1 row in set (0.04 sec)



# æŸ¥çœ‹è¡¨ç»“æ„
mysql> desc students;
+---------+-----------------------------------+------+-----+---------+----------------+
| Field   | Type                              | Null | Key | Default | Extra          |
+---------+-----------------------------------+------+-----+---------+----------------+
| id      | int(11)                           | NO   | PRI | NULL    | auto_increment |
| name    | varchar(64)                       | NO   |     | NULL    |                |
| age     | tinyint(3)                        | NO   |     | 0       |                |
| gender  | enum('ç”·','å¥³')                   | NO   |     | NULL    |                |
| address | enum('åŒ—äº¬','æ·±åœ³','äº‘å—','æ±Ÿè‹') | NO   |     | NULL    |                |
| intime  | datetime                          | NO   |     | NULL    |                |
| phone   | char(11)                          | NO   |     | NULL    |                |
+---------+-----------------------------------+------+-----+---------+----------------+
7 rows in set (0.05 sec)
```

### å¤åˆ¶æ•°æ®è¡¨

```
mysql> create table stu_back like students;
Query OK, 0 rows affected (0.00 sec)

mysql> show tables;
+------------------------+
| Tables_in_yuchao_linux |
+------------------------+
| stu_back               |
| students               |
+------------------------+
2 rows in set (0.05 sec)

mysql> desc stu_back;
+---------+-----------------------------------+------+-----+---------+----------------+
| Field   | Type                              | Null | Key | Default | Extra          |
+---------+-----------------------------------+------+-----+---------+----------------+
| id      | int(11)                           | NO   | PRI | NULL    | auto_increment |
| name    | varchar(64)                       | NO   |     | NULL    |                |
| age     | tinyint(3)                        | NO   |     | 0       |                |
| gender  | enum('ç”·','å¥³')                   | NO   |     | NULL    |                |
| address | enum('åŒ—äº¬','æ·±åœ³','äº‘å—','æ±Ÿè‹') | NO   |     | NULL    |                |
| intime  | datetime                          | NO   |     | NULL    |                |
| phone   | char(11)                          | NO   |     | NULL    |                |
+---------+-----------------------------------+------+-----+---------+----------------+
7 rows in set (0.03 sec)
```

## 1.9 ä¿®æ”¹è¡¨ç»“æ„

å’±å°±ä¸ç”¨å›¾å½¢åŒ–æ“ä½œäº†ï¼Œå­¦ä¹ åº•å±‚çš„SQLè¯­å¥

### ç»“å°¾åŠ å…¥ä¸€åˆ—

> ç»™studentsè¡¨æ·»åŠ ä¸€ä¸ªå…´è¶£å­—æ®µï¼Œhobby è¦æ±‚åªèƒ½è¾“å…¥20ä¸ªæ±‰å­—ä»¥å†…ï¼ˆ20ï¼‰

```
# ç»™studentsè¡¨æ·»åŠ ä¸€ä¸ªå…´è¶£å­—æ®µï¼Œhobby è¦æ±‚åªèƒ½è¾“å…¥20ä¸ªæ±‰å­—ä»¥å†…ï¼ˆ20ï¼‰

mysql> desc yuchao_linux.students;
+---------+-------------------------------------------+------+-----+---------+----------------+
| Field   | Type                                      | Null | Key | Default | Extra          |
+---------+-------------------------------------------+------+-----+---------+----------------+
| id      | int(11)                                   | NO   | PRI | NULL    | auto_increment |
| name    | varchar(64)                               | NO   |     | NULL    |                |
| age     | tinyint(3)                                | NO   |     | 0       |                |
| gender  | enum('ç”·','å¥³')                           | NO   |     | NULL    |                |
| address | enum('åŒ—äº¬','æ·±åœ³','äº‘å—','æ±Ÿè‹')         | NO   |     | NULL    |                |
| intime  | datetime                                  | NO   |     | NULL    |                |
| phone   | char(11)                                  | NO   |     | NULL    |                |
+---------+-------------------------------------------+------+-----+---------+----------------+
7 rows in set (0.00 sec)


è¯­æ³•ï¼š
ALTER TABLE è¡¨å  ADD COLUMN å­—æ®µå  æ•°æ®ç±»å‹  å­—æ®µçº¦æŸ  æ³¨é‡Š

æ¡ˆä¾‹
mysql> alter table yuchao_linux.students add column hobby char(20) not null  default 'å­¦ä¹ ' comment 'å­¦ç”Ÿçˆ±å¥½';
Query OK, 0 rows affected (0.01 sec)
Records: 0  Duplicates: 0  Warnings: 0
```

## tip:è¡¥å……floatç±»å‹

```
mysqlçš„floatè¯­æ³•

height float(æ€»å…±æœ‰å¤šå°‘ä½,å°æ•°ç‚¹åæœ‰å‡ ä½)
```

### åœ¨ç¬¬ä¸€åˆ—æ·»åŠ å­—æ®µ

æ·»åŠ èº«é«˜å­—æ®µï¼Œè¦æ±‚ä¸è¶…è¿‡3ä½æ•°ï¼Œæœ‰ä¸€ä½å°æ•°

```
mysql> alter table yuchao_linux.students add column height float(4,1)  default null comment 'å­¦ç”Ÿèº«é«˜' first;
Query OK, 0 rows affected (0.01 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql> desc yuchao_linux.students;
+---------+-------------------------------------------+------+-----+---------+----------------+
| Field   | Type                                      | Null | Key | Default | Extra          |
+---------+-------------------------------------------+------+-----+---------+----------------+
| height  | float(4,1)                                | YES  |     | NULL    |                |
| id      | int(11)                                   | NO   | PRI | NULL    | auto_increment |
| name    | varchar(64)                               | NO   |     | NULL    |                |
| age     | tinyint(3)                                | NO   |     | 0       |                |
| gender  | enum('ç”·','å¥³')                           | NO   |     | NULL    |                |
| address | enum('åŒ—äº¬','æ·±åœ³','äº‘å—','æ±Ÿè‹')         | NO   |     | NULL    |                |
| intime  | datetime                                  | NO   |     | NULL    |                |
| phone   | char(11)                                  | NO   |     | NULL    |                |
| hobby   | char(20)                                  | NO   |     | å­¦ä¹     |                |
+---------+-------------------------------------------+------+-----+---------+----------------+
9 rows in set (0.00 sec)
```

### åœ¨æŒ‡å®šå­—æ®µåæ·»åŠ 

```
mysql> alter table yuchao_linux.students drop height;
Query OK, 0 rows affected (0.01 sec)
Records: 0  Duplicates: 0  Warnings: 0


åœ¨æ€§åˆ«åé¢æ·»åŠ  heightèº«é«˜å­—æ®µ
alter table yuchao_linux.students add column height float(4,1)  default null comment 'å­¦ç”Ÿèº«é«˜' after gender;
```

### åˆ é™¤å­—æ®µ

```
åˆ é™¤å­—æ®µ
mysql> 
mysql> alter table yuchao_linux.students drop hobby;
Query OK, 0 rows affected (0.00 sec)
Records: 0  Duplicates: 0  Warnings: 0

å±é™©æ“ä½œï¼Œä¸èƒ½éšä¾¿åˆ é™¤æ•°æ®
```

## 1.10 ä¿®æ”¹è¡¨å±æ€§

### ä¿®æ”¹è¡¨å

```
mysql> alter table students rename to new_students;
Query OK, 0 rows affected (0.00 sec)


mysql> show tables;
+------------------------+
| Tables_in_yuchao_linux |
+------------------------+
| new_students           |
| stu_back               |
+------------------------+
2 rows in set (0.00 sec)
```

### ä¿®æ”¹è¡¨ç»“æ„ï¼Œæ•°æ®åº“å¼•æ“

```
åˆ›å»ºæµ‹è¯•æ•°æ®
create table t1(id int) engine=MYISAM;

mysql> 
mysql> show create table t1;
+-------+-----------------------------------------------------------------------------------------+
| Table | Create Table                                                                            |
+-------+-----------------------------------------------------------------------------------------+
| t1    | CREATE TABLE `t1` (
  `id` int(11) DEFAULT NULL
) ENGINE=MyISAM DEFAULT CHARSET=utf8mb4 |
+-------+-----------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> 
mysql> alter table t1 engine=innodb;
Query OK, 0 rows affected (0.00 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql> show create table t1;
+-------+-----------------------------------------------------------------------------------------+
| Table | Create Table                                                                            |
+-------+-----------------------------------------------------------------------------------------+
| t1    | CREATE TABLE `t1` (
  `id` int(11) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 |
+-------+-----------------------------------------------------------------------------------------+
1 row in set (0.00 sec)
```

### ä¿®æ”¹è¡¨ç»“æ„ï¼Œè¡¨å­—ç¬¦é›†

```
mysql> alter table t1 charset=latin1;
Query OK, 0 rows affected (0.00 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql> show create table t1;
+-------+----------------------------------------------------------------------------------------+
| Table | Create Table                                                                           |
+-------+----------------------------------------------------------------------------------------+
| t1    | CREATE TABLE `t1` (
  `id` int(11) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=latin1 |
+-------+----------------------------------------------------------------------------------------+
1 row in set (0.00 sec)
```

## 1.11 ä¿®æ”¹åˆ—å±æ€§

åŸºäºç›®å‰åˆ›å»ºçš„studentsè¡¨ï¼Œé»˜è®¤å®šä¹‰å¥½äº†å¾ˆå¤šçš„å­—æ®µï¼Œå­—æ®µçš„å±æ€§ä¹Ÿå¯ä»¥ä¿®æ”¹ã€‚

### changeå…³é”®å­—

```
ALTER TABLE <è¡¨å> CHANGE <æ—§å­—æ®µå> <æ–°å­—æ®µå> <æ–°æ•°æ®ç±»å‹>ï¼›

æ—§å­—æ®µåï¼šæŒ‡ä¿®æ”¹å‰çš„å­—æ®µåï¼›
æ–°å­—æ®µåï¼šæŒ‡ä¿®æ”¹åçš„å­—æ®µåï¼›
æ–°æ•°æ®ç±»å‹ï¼šæŒ‡ä¿®æ”¹åçš„æ•°æ®ç±»å‹ï¼Œå¦‚æœä¸éœ€è¦ä¿®æ”¹å­—æ®µçš„æ•°æ®ç±»å‹ï¼Œå¯ä»¥å°†æ–°æ•°æ®ç±»å‹è®¾ç½®æˆä¸åŸæ¥ä¸€æ ·ï¼Œä½†æ•°æ®ç±»å‹ä¸èƒ½ä¸ºç©ºã€‚

CHANGE ä¹Ÿå¯ä»¥åªä¿®æ”¹æ•°æ®ç±»å‹ï¼Œå®ç°å’Œ MODIFY åŒæ ·çš„æ•ˆæœï¼Œæ–¹æ³•æ˜¯å°† SQL è¯­å¥ä¸­çš„â€œæ–°å­—æ®µåâ€å’Œâ€œæ—§å­—æ®µåâ€è®¾ç½®ä¸ºç›¸åŒçš„åç§°ï¼Œåªæ”¹å˜â€œæ•°æ®ç±»å‹â€ã€‚

æç¤ºï¼šç”±äºä¸åŒç±»å‹çš„æ•°æ®åœ¨æœºå™¨ä¸­çš„å­˜å‚¨æ–¹å¼åŠé•¿åº¦å¹¶ä¸ç›¸åŒï¼Œä¿®æ”¹æ•°æ®ç±»å‹å¯èƒ½ä¼šå½±å“æ•°æ®è¡¨ä¸­å·²æœ‰çš„æ•°æ®è®°å½•ï¼Œå› æ­¤ï¼Œå½“æ•°æ®è¡¨ä¸­å·²ç»æœ‰æ•°æ®æ—¶ï¼Œä¸è¦è½»æ˜“ä¿®æ”¹æ•°æ®ç±»å‹
```

åªä¿®æ”¹å­—æ®µå

```
mysql> alter table stu_back change phone_num telephone_num varchar(11) NOT NULL DEFAULT '0' COMMENT 'æ‰‹æœºå·';
Query OK, 0 rows affected (0.00 sec)
Records: 0  Duplicates: 0  Warnings: 0
```

åªä¿®æ”¹é»˜è®¤å€¼

```
mysql> alter table stu_back change telephone_num telephone_num varchar(11) NOT NULL DEFAULT '15210858004' COMMENT 'æ‰‹æœºå·';
Query OK, 0 rows affected (0.00 sec)
Records: 0  Duplicates: 0  Warnings: 0
```

åŒæ—¶ä¿®æ”¹å­—æ®µåï¼Œå­—æ®µæ•°æ®ç±»å‹,é»˜è®¤å€¼

```
alter table stu_back change phone phone_num varchar(11) not null default '0' comment 'æ‰‹æœºå·';
```

### modifyå…³é”®å­—

```
ä¿®æ”¹å­—æ®µçš„æ•°æ®ç±»å‹å°±æ˜¯æŠŠå­—æ®µçš„æ•°æ®ç±»å‹è½¬æ¢æˆå¦ä¸€ç§æ•°æ®ç±»å‹ã€‚

åœ¨ MySQL ä¸­ä¿®æ”¹å­—æ®µæ•°æ®ç±»å‹çš„è¯­æ³•è§„åˆ™å¦‚ä¸‹ï¼š
ALTER TABLE <è¡¨å> MODIFY <å­—æ®µå> <æ•°æ®ç±»å‹>

å…¶ä¸­ï¼š
è¡¨åï¼šæŒ‡è¦ä¿®æ”¹æ•°æ®ç±»å‹çš„å­—æ®µæ‰€åœ¨è¡¨çš„åç§°ï¼›
å­—æ®µåï¼šæŒ‡éœ€è¦ä¿®æ”¹çš„å­—æ®µï¼›
æ•°æ®ç±»å‹ï¼šæŒ‡ä¿®æ”¹åå­—æ®µçš„æ–°æ•°æ®ç±»å‹ã€‚


ä¿®æ”¹telephone_numçš„æ•°æ®ç±»å‹ï¼Œæ”¹ä¸ºchar(11)

æ³¨æ„ï¼Œå¦‚æœå…¶ä»–å±æ€§ï¼Œä¸å¸Œæœ›æ”¹å˜ï¼Œä¹Ÿè¦åŠ ä¸Šï¼Œå¦åˆ™å°±ä¸¢å¤±äº†

mysql> alter table stu_back modify telephone_num char(11) not null;
Query OK, 0 rows affected (0.01 sec)
Records: 0  Duplicates: 0  Warnings: 0
```

## 1.12 åˆ é™¤æ•°æ®è¡¨

å±é™©æ“ä½œ

```
mysql> drop table stu_back;
Query OK, 0 rows affected (0.00 sec)
```